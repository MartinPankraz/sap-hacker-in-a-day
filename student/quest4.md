# Quest 4 - Create a custom detection rule (Experts | optional)

[< Quest 3 ](quest3.md) - **[üè†Home](../README.md)** - [ Quest 5 >](quest5.md)

Standard out-of-the-box detections are great, but sometimes you need to create a custom detection rule to catch a specific threat. In the previous quest, you alerted on static pre-configured IP ranges. Now, we will expand scope and think global access.

* Use built-in KQL functions like `geo_info_from_ip_address` to create a detection that alerts on logins from Germany.

* Take inspiration from [this blog post](https://community.sap.com/t5/technology-blogs-by-members/nice-patch-sap-revisiting-your-sap-btp-security-measures-after-ai-core/ba-p/13770662).

## Where to next?

[< Quest 3 ](quest3.md) - **[üè†Home](../README.md)** - [ Quest 5 >](quest5.md)

[üîù](#)
